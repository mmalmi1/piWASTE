{% extends 'base.html' %}

{% block head %}

   <!-- Custom styles for this template -->
      
{% endblock %}


{% block body %}

<div class="container">
    <div class="main-body" style="padding-top: 10%;">
        <div class="row gutters-sm">
            <div class="col-md-4 mb-3">
                <div class="card">
                    <div class="card-body">
                        <div class="d-flex flex-column align-items-center text-center">
                            <img src="{{url_for('static', filename='assets/profile.png')}}" alt="Admin" class="rounded-circle" width="150">
                            <div class="mt-3">
                                <h4>{{ name }}</h4>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-8 profile-info">
                <div class="card mb-3">
                    <div class="card-body">
                        <div class="row">
                            <div class="col-sm-3">
                                <h6 class="mb-0">User name</h6>
                            </div>
                            <div class="col-sm-9 text-secondary">{{ username }}</div>
                        </div>
                        <hr>
                        <div class="row">
                            <div class="col-sm-3">
                                <h6 class="mb-0">Email</h6>
                            </div>
                            <div class="col-sm-9 text-secondary">{{ email }}</div>
                        </div>
                        <hr>
                        <div class="row">
                            <div class="col-sm-3">
                                <h6 class="mb-0">Phone</h6>
                            </div>
                            <div class="col-sm-9 text-secondary">{{ phone }}</div>
                        </div>
                        <hr>
                        <div class="row">
                            <div class="col-sm-3">
                                <h6 class="mb-0">Address</h6>
                            </div>
                            <div class="col-sm-9 text-secondary">{{ address }}</div>
                        </div>
                    </div>
                </div>
                <a class="form-inline mt-2 mt-md-0" href="{{ url_for('profile.edit') }}">
                    <button class="btn btn-outline-dark edit-button" type="submit">Edit profile</button>
                </a>
            </div>
        </div>
    </div>
</div>

{% endblock %}


{% block script %}

<script>
    var raw = $(`
    <div class="row">
        <div class="col-sm-3">
            <h6 class="mb-0">29/11/2020</h6>
        </div>
        <div class="col-sm-9 text-secondary">Teddy: 3 <br> Guitar: 1</div>
        </div>
    <hr>`);

    fetch(`../get_purchase_history/${cookie.user_id}`).then(function(response){
        return response.json();
    }).then(function(json) {
        $(".profile-info").append("<h4>Purchase history</h4><hr>");
        if (json.length == 0) {
            console.log("empty");
        } 
        for(var i=0; i<json.length; i++) {
            let { user_id, shopping_cart, timestamp } = json[i];
            console.log(json[i]);
        };
        
        // Create clone so old one doesn't get erased!
        card = raw.clone();

        // Append item to deck, find by class card-deck
        card.appendTo($(".profile-info"));

    });
</script>

{% endblock %}